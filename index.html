<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Single Parent Yearly Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .fade-in { animation: fadeIn 0.5s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .toast { position: fixed; top: 20px; right: 20px; z-index: 1000; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-green-50 min-h-screen font-sans">
    <!-- Progress Bar -->
    <div class="bg-white shadow-sm border-b">
        <div class="max-w-4xl mx-auto px-4 py-3">
            <div class="flex items-center justify-between mb-2">
                <h1 class="text-xl font-semibold text-gray-800">Single Parent Yearly Planner</h1>
                <span class="text-sm text-gray-600" id="stepCounter">Step 1 of 9</span>
            </div>
            <div class="w-full bg-gray-200 rounded-full h-2">
                <div class="bg-gradient-to-r from-blue-500 to-green-500 h-2 rounded-full transition-all duration-500" id="progressBar" style="width: 11.11%"></div>
            </div>
        </div>
    </div>

    <!-- Main Container -->
    <div class="max-w-4xl mx-auto px-4 py-8">
        <!-- Toast Container -->
        <div id="toastContainer" class="toast"></div>

        <!-- Form Container -->
        <div class="bg-white rounded-lg shadow-lg p-8 fade-in">
            <form id="plannerForm" class="space-y-8">
                
                <!-- Step 1: Personal Basics -->
                <div class="step" id="step1">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Personal Basics</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Child's Age</label>
                            <input type="number" id="childAge" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" max="18" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Child's Birthday Month</label>
                            <select id="birthdayMonth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                <option value="">Select Month</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Income ($)</label>
                            <input type="number" id="monthlyIncome" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Fixed Monthly Expenses ($)</label>
                            <input type="number" id="fixedExpenses" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Current Savings ($)</label>
                            <input type="number" id="currentSavings" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Current Debt ($)</label>
                            <input type="number" id="currentDebt" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                        </div>
                    </div>
                </div>

                <!-- Step 2: Financial Goals -->
                <div class="step hidden" id="step2">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Financial Goals</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Emergency Fund Target ($)</label>
                            <input type="number" id="emergencyFund" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">School Fees Goal ($)</label>
                            <input type="number" id="schoolFees" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">House Down Payment Target ($)</label>
                            <input type="number" id="houseDownPayment" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Monthly Side Hustle Potential ($)</label>
                            <input type="number" id="sideHustle" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                        </div>
                    </div>
                </div>

                <!-- Step 3: Holiday Planning -->
                <div class="step hidden" id="step3">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Holiday Planning</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Birthday Trip Month</label>
                            <select id="tripMonth" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                <option value="">Select Month</option>
                                <option value="January">January</option>
                                <option value="February">February</option>
                                <option value="March">March</option>
                                <option value="April">April</option>
                                <option value="May">May</option>
                                <option value="June">June</option>
                                <option value="July">July</option>
                                <option value="August">August</option>
                                <option value="September">September</option>
                                <option value="October">October</option>
                                <option value="November">November</option>
                                <option value="December">December</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Trip Budget ($)</label>
                            <input type="number" id="tripBudget" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" required>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Trip Preferences</label>
                            <select id="tripPreferences" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" required>
                                <option value="">Select Preference</option>
                                <option value="Beach">Beach</option>
                                <option value="Park">Park</option>
                                <option value="Theme Park">Theme Park</option>
                                <option value="Museum">Museum</option>
                                <option value="Zoo">Zoo</option>
                                <option value="Other">Other</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Location Ideas</label>
                            <input type="text" id="locationIdeas" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Local beach, Disney World, etc.">
                        </div>
                    </div>
                </div>

                <!-- Step 4: Personal Growth -->
                <div class="step hidden" id="step4">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Personal Growth</h2>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Reading Goal (books per month)</label>
                            <input type="number" id="readingGoal" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.1" value="1">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Reading Themes/Genres</label>
                            <input type="text" id="readingThemes" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="e.g., Parenting, Self-help, Fiction">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Exercise Frequency (times per week)</label>
                            <input type="number" id="exerciseFrequency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" max="7" value="3">
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Exercise Types</label>
                            <select id="exerciseTypes" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                <option value="Cardio">Cardio</option>
                                <option value="Strength Training">Strength Training</option>
                                <option value="Yoga">Yoga</option>
                                <option value="Mixed">Mixed</option>
                                <option value="Walking">Walking</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Child & Routine -->
                <div class="step hidden" id="step5">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Child & Routine</h2>
                    <div class="space-y-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-3">Age-Appropriate Milestones to Focus On</label>
                            <div class="mb-4 p-3 bg-blue-50 rounded-lg">
                                <p class="text-sm text-blue-800" id="milestoneInfo">
                                    Select your child's age in Step 1 to see age-appropriate milestones
                                </p>
                            </div>
                            <div id="milestonesContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <!-- Milestones will be dynamically populated based on child's age -->
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Wake-up Time</label>
                                <input type="time" id="wakeUpTime" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="07:00">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Bedtime</label>
                                <input type="time" id="bedtime" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" value="20:00">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Meal Times (e.g., 8:00, 12:00, 18:00)</label>
                                <input type="text" id="mealTimes" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" placeholder="8:00, 12:00, 18:00">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Insurance & Protection -->
                <div class="step hidden" id="step6">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Insurance & Protection</h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Health Insurance Monthly Premium ($)</label>
                                <input type="number" id="healthInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Health Insurance Deductible ($)</label>
                                <input type="number" id="healthDeductible" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Pediatrician Co-pay ($)</label>
                                <input type="number" id="pediatricianCopay" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Vision/Dental Monthly ($)</label>
                                <input type="number" id="visionDental" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Life Insurance Monthly ($)</label>
                                <input type="number" id="lifeInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Life Insurance Coverage Amount ($)</label>
                                <input type="number" id="lifeCoverage" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Auto Insurance Quarterly ($)</label>
                                <input type="number" id="autoInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Home/Renters Insurance Quarterly ($)</label>
                                <input type="number" id="homeInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Disability Insurance Monthly ($)</label>
                                <input type="number" id="disabilityInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Pet Insurance Monthly ($)</label>
                                <input type="number" id="petInsurance" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 7: Childcare & Education -->
                <div class="step hidden" id="step7">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Childcare & Education Logistics</h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Current Childcare Monthly ($)</label>
                                <input type="number" id="currentChildcare" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">After-School Programs Monthly ($)</label>
                                <input type="number" id="afterSchoolPrograms" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Summer Camp Weekly Budget ($)</label>
                                <input type="number" id="summerCampBudget" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Extracurriculars Monthly ($)</label>
                                <input type="number" id="extracurriculars" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">School Supplies Annual ($)</label>
                                <input type="number" id="schoolSupplies" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Uniforms/Clothing Annual ($)</label>
                                <input type="number" id="schoolClothing" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Upcoming Education Deadlines</label>
                            <textarea id="educationDeadlines" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3" placeholder="e.g., Kindergarten registration: March 15, School supply lists: July 1"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 8: Legal & Administrative -->
                <div class="step hidden" id="step8">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Legal & Administrative</h2>
                    <div class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Child Support Monthly ($)</label>
                                <input type="number" id="childSupport" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Legal Fees Annual ($)</label>
                                <input type="number" id="legalFees" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Tax Preparation Annual ($)</label>
                                <input type="number" id="taxPreparation" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Will/Guardianship Updates ($)</label>
                                <input type="number" id="willUpdates" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="0" step="0.01" value="0">
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Government Benefits Status</label>
                            <div class="grid grid-cols-2 md:grid-cols-4 gap-3">
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" value="SNAP" class="benefits-checkbox">
                                    <span class="text-sm">SNAP</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" value="WIC" class="benefits-checkbox">
                                    <span class="text-sm">WIC</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" value="Childcare Subsidy" class="benefits-checkbox">
                                    <span class="text-sm">Childcare Subsidy</span>
                                </label>
                                <label class="flex items-center space-x-2">
                                    <input type="checkbox" value="Medicaid" class="benefits-checkbox">
                                    <span class="text-sm">Medicaid</span>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">Legal/Administrative Notes</label>
                            <textarea id="legalNotes" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent" rows="3" placeholder="e.g., Child support modification review: June, Will update needed: December"></textarea>
                        </div>
                    </div>
                </div>

                <!-- Step 9: Review -->
                <div class="step hidden" id="step9">
                    <h2 class="text-2xl font-semibold text-gray-800 mb-6">Review Your Complete Plan</h2>
                    <div class="bg-gray-50 rounded-lg p-6 space-y-4">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3">Financial Summary</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Monthly Income:</span>
                                        <span id="reviewIncome">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Monthly Expenses:</span>
                                        <span id="reviewExpenses">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Monthly Savings Potential:</span>
                                        <span id="reviewSavings">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Emergency Fund Target:</span>
                                        <span id="reviewEmergency">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>School Fees Goal:</span>
                                        <span id="reviewSchool">$0</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3">Goals Timeline</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Months to Save Emergency Fund:</span>
                                        <span id="reviewEmergencyMonths">0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Months to Save School Fees:</span>
                                        <span id="reviewSchoolMonths">0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Books to Read This Year:</span>
                                        <span id="reviewBooks">0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Workouts This Year:</span>
                                        <span id="reviewWorkouts">0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3">Insurance & Protection</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Monthly Insurance Total:</span>
                                        <span id="reviewInsurance">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Life Coverage Amount:</span>
                                        <span id="reviewLifeCoverage">$0</span>
                                    </div>
                                </div>
                            </div>
                            <div>
                                <h3 class="font-semibold text-gray-800 mb-3">Childcare & Education</h3>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Monthly Childcare Total:</span>
                                        <span id="reviewChildcare">$0</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Annual Education Costs:</span>
                                        <span id="reviewEducation">$0</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="flex justify-between pt-6 border-t">
                    <button type="button" id="prevBtn" class="px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors hidden">Previous</button>
                    <button type="button" id="nextBtn" class="px-6 py-3 bg-gradient-to-r from-blue-500 to-green-500 text-white rounded-lg hover:from-blue-600 hover:to-green-600 transition-all ml-auto">Next</button>
                    <button type="button" id="generateBtn" class="px-6 py-3 bg-gradient-to-r from-green-500 to-blue-500 text-white rounded-lg hover:from-green-600 hover:to-blue-600 transition-all hidden">Generate My Plan</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentStep = 1;
        const totalSteps = 9;
        const formData = {};

        // Comprehensive child development milestones by age
        const milestonesByAge = {
            0: {
                title: "Infant (0-12 months)",
                milestones: [
                    "Lifts head when lying on tummy",
                    "Follows objects with eyes",
                    "Responds to familiar voices",
                    "Rolls over (tummy to back)",
                    "Sits without support",
                    "Crawls or scoots",
                    "Pulls to standing",
                    "Says first words (mama, dada)",
                    "Waves bye-bye",
                    "Drinks from a cup",
                    "Finger feeds self",
                    "Sleeps through the night"
                ]
            },
            1: {
                title: "Toddler (12-24 months)",
                milestones: [
                    "Walks independently",
                    "Says 10-20 words",
                    "Follows simple instructions",
                    "Points to body parts",
                    "Uses spoon/fork",
                    "Plays simple pretend games",
                    "Shows affection",
                    "Imitates others",
                    "Builds tower of 2-3 blocks",
                    "Scribbles with crayon",
                    "Shows independence",
                    "Has temper tantrums"
                ]
            },
            2: {
                title: "Toddler (2-3 years)",
                milestones: [
                    "Runs and jumps",
                    "Speaks in 2-3 word sentences",
                    "Follows 2-step instructions",
                    "Uses toilet with help",
                    "Dresses self partially",
                    "Plays with other children",
                    "Shows empathy",
                    "Counts to 10",
                    "Recognizes colors",
                    "Builds tower of 6+ blocks",
                    "Draws circles and lines",
                    "Shows imagination in play"
                ]
            },
            3: {
                title: "Preschooler (3-4 years)",
                milestones: [
                    "Rides tricycle",
                    "Speaks clearly in sentences",
                    "Asks 'why' questions",
                    "Uses toilet independently",
                    "Dresses self completely",
                    "Shares and takes turns",
                    "Shows concern for others",
                    "Counts to 20",
                    "Recognizes letters",
                    "Cuts with scissors",
                    "Draws recognizable pictures",
                    "Engages in cooperative play"
                ]
            },
            4: {
                title: "Preschooler (4-5 years)",
                milestones: [
                    "Hops on one foot",
                    "Tells stories",
                    "Follows 3-step instructions",
                    "Washes hands independently",
                    "Ties shoes (with practice)",
                    "Plays organized games",
                    "Shows leadership",
                    "Counts to 50",
                    "Recognizes some sight words",
                    "Writes name",
                    "Draws detailed pictures",
                    "Understands rules and fairness"
                ]
            },
            5: {
                title: "Kindergarten (5-6 years)",
                milestones: [
                    "Skips and gallops",
                    "Reads simple books",
                    "Follows classroom rules",
                    "Completes homework",
                    "Packs own backpack",
                    "Makes friends easily",
                    "Resolves conflicts",
                    "Counts to 100",
                    "Reads sight words",
                    "Writes simple sentences",
                    "Draws complex scenes",
                    "Shows responsibility"
                ]
            },
            6: {
                title: "Early Elementary (6-7 years)",
                milestones: [
                    "Rides bicycle",
                    "Reads chapter books",
                    "Completes assignments",
                    "Manages time",
                    "Organizes belongings",
                    "Works in groups",
                    "Shows empathy",
                    "Does basic math",
                    "Spells common words",
                    "Writes paragraphs",
                    "Creates art projects",
                    "Follows routines"
                ]
            },
            7: {
                title: "Elementary (7-8 years)",
                milestones: [
                    "Plays team sports",
                    "Reads for pleasure",
                    "Takes responsibility",
                    "Manages homework",
                    "Keeps room tidy",
                    "Builds friendships",
                    "Shows leadership",
                    "Solves word problems",
                    "Writes stories",
                    "Creates detailed art",
                    "Follows complex rules",
                    "Shows independence"
                ]
            },
            8: {
                title: "Elementary (8-9 years)",
                milestones: [
                    "Masters physical skills",
                    "Reads complex books",
                    "Sets personal goals",
                    "Manages projects",
                    "Organizes schedule",
                    "Resolves peer conflicts",
                    "Shows compassion",
                    "Does multi-step math",
                    "Writes essays",
                    "Creates original art",
                    "Understands consequences",
                    "Shows self-discipline"
                ]
            },
            9: {
                title: "Upper Elementary (9-10 years)",
                milestones: [
                    "Excels in chosen sports",
                    "Reads diverse genres",
                    "Pursues interests",
                    "Manages long-term projects",
                    "Maintains organization",
                    "Builds strong friendships",
                    "Shows emotional maturity",
                    "Solves complex problems",
                    "Writes creatively",
                    "Develops artistic style",
                    "Makes ethical decisions",
                    "Shows self-motivation"
                ]
            },
            10: {
                title: "Pre-Teen (10-11 years)",
                milestones: [
                    "Develops athletic skills",
                    "Reads critically",
                    "Pursues passions",
                    "Manages multiple projects",
                    "Stays organized",
                    "Navigates social dynamics",
                    "Shows emotional intelligence",
                    "Applies math to real life",
                    "Writes persuasively",
                    "Creates original works",
                    "Makes moral judgments",
                    "Shows self-direction"
                ]
            },
            11: {
                title: "Pre-Teen (11-12 years)",
                milestones: [
                    "Masters physical activities",
                    "Reads for understanding",
                    "Develops expertise",
                    "Plans long-term goals",
                    "Maintains systems",
                    "Builds peer relationships",
                    "Shows emotional regulation",
                    "Uses math in context",
                    "Writes analytically",
                    "Expresses creativity",
                    "Makes responsible choices",
                    "Shows initiative"
                ]
            },
            12: {
                title: "Teen (12-13 years)",
                milestones: [
                    "Develops athletic identity",
                    "Reads for analysis",
                    "Pursues specialized interests",
                    "Sets academic goals",
                    "Manages complex schedules",
                    "Forms close friendships",
                    "Shows emotional maturity",
                    "Applies advanced math",
                    "Writes research papers",
                    "Develops artistic voice",
                    "Makes ethical decisions",
                    "Shows self-advocacy"
                ]
            },
            13: {
                title: "Teen (13-14 years)",
                milestones: [
                    "Commits to activities",
                    "Reads for synthesis",
                    "Develops career interests",
                    "Plans for future",
                    "Balances responsibilities",
                    "Navigates peer pressure",
                    "Shows emotional intelligence",
                    "Uses math in careers",
                    "Writes argumentatively",
                    "Creates portfolio",
                    "Makes moral choices",
                    "Shows leadership"
                ]
            },
            14: {
                title: "Teen (14-15 years)",
                milestones: [
                    "Excels in chosen areas",
                    "Reads for evaluation",
                    "Explores career paths",
                    "Sets life goals",
                    "Manages priorities",
                    "Builds romantic relationships",
                    "Shows emotional stability",
                    "Applies math to problems",
                    "Writes professionally",
                    "Develops expertise",
                    "Makes ethical decisions",
                    "Shows independence"
                ]
            },
            15: {
                title: "Teen (15-16 years)",
                milestones: [
                    "Achieves mastery",
                    "Reads for insight",
                    "Pursues career preparation",
                    "Plans for college/career",
                    "Balances work/study",
                    "Forms deep relationships",
                    "Shows emotional wisdom",
                    "Uses advanced math",
                    "Writes for publication",
                    "Creates original work",
                    "Makes life decisions",
                    "Shows self-reliance"
                ]
            },
            16: {
                title: "Teen (16-17 years)",
                milestones: [
                    "Leads in activities",
                    "Reads for wisdom",
                    "Prepares for career",
                    "Plans for independence",
                    "Manages adult responsibilities",
                    "Builds lasting relationships",
                    "Shows emotional maturity",
                    "Applies math professionally",
                    "Writes for purpose",
                    "Creates meaningful art",
                    "Makes moral choices",
                    "Shows self-determination"
                ]
            },
            17: {
                title: "Young Adult (17-18 years)",
                milestones: [
                    "Mentors others",
                    "Reads for growth",
                    "Pursues career goals",
                    "Plans for adulthood",
                    "Manages full independence",
                    "Forms adult relationships",
                    "Shows emotional intelligence",
                    "Uses math in career",
                    "Writes for impact",
                    "Creates legacy work",
                    "Makes ethical decisions",
                    "Shows self-actualization"
                ]
            }
        };

        // DOM elements
        const steps = document.querySelectorAll('.step');
        const progressBar = document.getElementById('progressBar');
        const stepCounter = document.getElementById('stepCounter');
        const nextBtn = document.getElementById('nextBtn');
        const prevBtn = document.getElementById('prevBtn');
        const generateBtn = document.getElementById('generateBtn');
        const toastContainer = document.getElementById('toastContainer');

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            loadFromLocalStorage();
            updateStepDisplay();
            setupEventListeners();
            updateMilestones();
        });

        // Event listeners
        function setupEventListeners() {
            nextBtn.addEventListener('click', nextStep);
            prevBtn.addEventListener('click', prevStep);
            generateBtn.addEventListener('click', generatePlan);
            
            // Auto-save on input change
            document.querySelectorAll('input, select').forEach(input => {
                input.addEventListener('change', saveToLocalStorage);
                input.addEventListener('input', saveToLocalStorage);
            });

            // Update milestones when child age changes
            document.getElementById('childAge').addEventListener('input', updateMilestones);
        }

        // Navigation functions
        function nextStep() {
            if (validateCurrentStep()) {
                if (currentStep < totalSteps) {
                    currentStep++;
                    updateStepDisplay();
                }
            }
        }

        function prevStep() {
            if (currentStep > 1) {
                currentStep--;
                updateStepDisplay();
            }
        }

        function updateStepDisplay() {
            // Hide all steps
            steps.forEach(step => step.classList.add('hidden'));
            
            // Show current step
            document.getElementById(`step${currentStep}`).classList.remove('hidden');
            
            // Update progress bar
            const progress = (currentStep / totalSteps) * 100;
            progressBar.style.width = `${progress}%`;
            
            // Update step counter
            stepCounter.textContent = `Step ${currentStep} of ${totalSteps}`;
            
            // Update buttons
            prevBtn.classList.toggle('hidden', currentStep === 1);
            nextBtn.classList.toggle('hidden', currentStep === totalSteps);
            generateBtn.classList.toggle('hidden', currentStep !== totalSteps);
            
            // Update review data if on last step
            if (currentStep === totalSteps) {
                updateReviewData();
            }
        }

        // Validation
        function validateCurrentStep() {
            const currentStepElement = document.getElementById(`step${currentStep}`);
            const requiredInputs = currentStepElement.querySelectorAll('[required]');
            
            for (let input of requiredInputs) {
                if (!input.value.trim()) {
                    showToast(`${input.previousElementSibling.textContent} is required`, 'error');
                    input.focus();
                    return false;
                }
                
                if (input.type === 'number' && parseFloat(input.value) < 0) {
                    showToast(`${input.previousElementSibling.textContent} must be positive`, 'error');
                    input.focus();
                    return false;
                }
            }
            
            return true;
        }

        // Local storage functions
        function saveToLocalStorage() {
            const data = {};
            document.querySelectorAll('input, select').forEach(input => {
                if (input.type === 'checkbox') {
                    data[input.id] = input.checked;
                } else {
                    data[input.id] = input.value;
                }
            });
            localStorage.setItem('plannerData', JSON.stringify(data));
        }

        function loadFromLocalStorage() {
            const saved = localStorage.getItem('plannerData');
            if (saved) {
                const data = JSON.parse(saved);
                Object.keys(data).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = data[key];
                        } else {
                            element.value = data[key];
                        }
                    }
                });
            }
        }

        // Review data update
        function updateReviewData() {
            const income = parseFloat(document.getElementById('monthlyIncome').value) || 0;
            const expenses = parseFloat(document.getElementById('fixedExpenses').value) || 0;
            const emergency = parseFloat(document.getElementById('emergencyFund').value) || 0;
            const school = parseFloat(document.getElementById('schoolFees').value) || 0;
            const readingGoal = parseFloat(document.getElementById('readingGoal').value) || 0;
            const exerciseFreq = parseFloat(document.getElementById('exerciseFrequency').value) || 0;
            
            // Calculate insurance totals
            const healthInsurance = parseFloat(document.getElementById('healthInsurance').value) || 0;
            const visionDental = parseFloat(document.getElementById('visionDental').value) || 0;
            const lifeInsurance = parseFloat(document.getElementById('lifeInsurance').value) || 0;
            const autoInsurance = (parseFloat(document.getElementById('autoInsurance').value) || 0) / 3; // Quarterly to monthly
            const homeInsurance = (parseFloat(document.getElementById('homeInsurance').value) || 0) / 3; // Quarterly to monthly
            const disabilityInsurance = parseFloat(document.getElementById('disabilityInsurance').value) || 0;
            const petInsurance = parseFloat(document.getElementById('petInsurance').value) || 0;
            const insuranceTotal = healthInsurance + visionDental + lifeInsurance + autoInsurance + homeInsurance + disabilityInsurance + petInsurance;
            
            // Calculate childcare totals
            const currentChildcare = parseFloat(document.getElementById('currentChildcare').value) || 0;
            const afterSchoolPrograms = parseFloat(document.getElementById('afterSchoolPrograms').value) || 0;
            const extracurriculars = parseFloat(document.getElementById('extracurriculars').value) || 0;
            const childcareTotal = currentChildcare + afterSchoolPrograms + extracurriculars;
            
            // Calculate education costs
            const schoolSupplies = parseFloat(document.getElementById('schoolSupplies').value) || 0;
            const schoolClothing = parseFloat(document.getElementById('schoolClothing').value) || 0;
            const summerCampBudget = parseFloat(document.getElementById('summerCampBudget').value) || 0;
            const educationTotal = schoolSupplies + schoolClothing + (summerCampBudget * 8); // 8 weeks of summer
            
            const savings = income - expenses;
            const emergencyMonths = emergency > 0 && savings > 0 ? Math.ceil(emergency / savings) : 0;
            const schoolMonths = school > 0 && savings > 0 ? Math.ceil(school / savings) : 0;
            const booksYear = readingGoal * 12;
            const workoutsYear = exerciseFreq * 52;
            const lifeCoverage = parseFloat(document.getElementById('lifeCoverage').value) || 0;
            
            document.getElementById('reviewIncome').textContent = `$${income.toLocaleString()}`;
            document.getElementById('reviewExpenses').textContent = `$${expenses.toLocaleString()}`;
            document.getElementById('reviewSavings').textContent = `$${savings.toLocaleString()}`;
            document.getElementById('reviewEmergency').textContent = `$${emergency.toLocaleString()}`;
            document.getElementById('reviewSchool').textContent = `$${school.toLocaleString()}`;
            document.getElementById('reviewEmergencyMonths').textContent = emergencyMonths;
            document.getElementById('reviewSchoolMonths').textContent = schoolMonths;
            document.getElementById('reviewBooks').textContent = booksYear;
            document.getElementById('reviewWorkouts').textContent = workoutsYear;
            document.getElementById('reviewInsurance').textContent = `$${insuranceTotal.toLocaleString()}`;
            document.getElementById('reviewLifeCoverage').textContent = `$${lifeCoverage.toLocaleString()}`;
            document.getElementById('reviewChildcare').textContent = `$${childcareTotal.toLocaleString()}`;
            document.getElementById('reviewEducation').textContent = `$${educationTotal.toLocaleString()}`;
        }

        // Excel generation
        function generatePlan() {
            if (!validateCurrentStep()) return;
            
            try {
                // Collect all form data
                const data = collectFormData();
                
                // Create workbook
                const wb = XLSX.utils.book_new();
                
                // Create sheets
                createOverviewSheet(wb, data);
                createBudgetSheet(wb, data);
                createFinancialTrackerSheet(wb, data);
                createHolidayPlanSheet(wb, data);
                createReadingExerciseSheet(wb, data);
                createRoutinesSheet(wb, data);
                createInsuranceSheet(wb, data);
                createChildcareEducationSheet(wb, data);
                createLegalAdministrativeSheet(wb, data);
                
                // Generate and download file
                const fileName = `MyFamilyPlan_${new Date().toISOString().split('T')[0]}.xlsx`;
                XLSX.writeFile(wb, fileName);
                
                // Clear localStorage
                localStorage.removeItem('plannerData');
                
                showToast('Your family plan has been generated and downloaded!', 'success');
                
            } catch (error) {
                showToast('Error generating plan. Please try again.', 'error');
                console.error('Error:', error);
            }
        }

        function collectFormData() {
            const data = {};
            document.querySelectorAll('input, select').forEach(input => {
                if (input.type === 'checkbox') {
                    data[input.id] = input.checked;
                } else {
                    data[input.id] = input.value;
                }
            });
            return data;
        }

        function createOverviewSheet(wb, data) {
            const overview = [
                ['Single Parent Yearly Planner - Overview'],
                [''],
                ['Personal Information'],
                ['Child Age:', data.childAge],
                ['Birthday Month:', data.birthdayMonth],
                ['Monthly Income:', `$${parseFloat(data.monthlyIncome || 0).toLocaleString()}`],
                ['Fixed Expenses:', `$${parseFloat(data.fixedExpenses || 0).toLocaleString()}`],
                ['Current Savings:', `$${parseFloat(data.currentSavings || 0).toLocaleString()}`],
                ['Current Debt:', `$${parseFloat(data.currentDebt || 0).toLocaleString()}`],
                [''],
                ['Financial Goals'],
                ['Emergency Fund Target:', `$${parseFloat(data.emergencyFund || 0).toLocaleString()}`],
                ['School Fees Goal:', `$${parseFloat(data.schoolFees || 0).toLocaleString()}`],
                ['House Down Payment:', `$${parseFloat(data.houseDownPayment || 0).toLocaleString()}`],
                ['Monthly Side Hustle:', `$${parseFloat(data.sideHustle || 0).toLocaleString()}`],
                [''],
                ['Personal Growth Goals'],
                ['Reading Goal (books/month):', data.readingGoal],
                ['Exercise Frequency (times/week):', data.exerciseFrequency],
                ['Exercise Type:', data.exerciseTypes]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(overview);
            XLSX.utils.book_append_sheet(wb, ws, 'Overview');
        }

        function createBudgetSheet(wb, data) {
            const income = parseFloat(data.monthlyIncome || 0);
            const expenses = parseFloat(data.fixedExpenses || 0);
            const savings = income - expenses;
            
            const budget = [
                ['Monthly Budget - 50/30/20 Rule'],
                [''],
                ['Category', 'Amount', 'Percentage', 'Notes'],
                ['Needs (50%)', `$${Math.round(income * 0.5).toLocaleString()}`, '50%', 'Housing, food, utilities, childcare'],
                ['Wants (30%)', `$${Math.round(income * 0.3).toLocaleString()}`, '30%', 'Entertainment, dining out, hobbies'],
                ['Savings (20%)', `$${Math.round(income * 0.2).toLocaleString()}`, '20%', 'Emergency fund, goals, investments'],
                [''],
                ['Current Situation'],
                ['Monthly Income', `$${income.toLocaleString()}`],
                ['Fixed Expenses', `$${expenses.toLocaleString()}`],
                ['Available for Goals', `$${savings.toLocaleString()}`],
                [''],
                ['Quarterly Breakdown'],
                ['Q1', `$${Math.round(income * 3).toLocaleString()}`],
                ['Q2', `$${Math.round(income * 3).toLocaleString()}`],
                ['Q3', `$${Math.round(income * 3).toLocaleString()}`],
                ['Q4', `$${Math.round(income * 3).toLocaleString()}`]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(budget);
            XLSX.utils.book_append_sheet(wb, ws, 'Budget');
        }

        function createFinancialTrackerSheet(wb, data) {
            const income = parseFloat(data.monthlyIncome || 0);
            const expenses = parseFloat(data.fixedExpenses || 0);
            const savings = income - expenses;
            const emergency = parseFloat(data.emergencyFund || 0);
            const school = parseFloat(data.schoolFees || 0);
            const house = parseFloat(data.houseDownPayment || 0);
            
            const tracker = [
                ['Financial Progress Tracker'],
                [''],
                ['Goal', 'Target Amount', 'Current Amount', 'Remaining', 'Monthly Target', 'Months to Goal'],
                ['Emergency Fund', `$${emergency.toLocaleString()}`, `$${parseFloat(data.currentSavings || 0).toLocaleString()}`, `$${(emergency - parseFloat(data.currentSavings || 0)).toLocaleString()}`, `$${Math.max(0, Math.ceil((emergency - parseFloat(data.currentSavings || 0)) / 12)).toLocaleString()}`, emergency > 0 && savings > 0 ? Math.ceil((emergency - parseFloat(data.currentSavings || 0)) / savings) : 0],
                ['School Fees', `$${school.toLocaleString()}`, '$0', `$${school.toLocaleString()}`, `$${Math.max(0, Math.ceil(school / 12)).toLocaleString()}`, school > 0 && savings > 0 ? Math.ceil(school / savings) : 0],
                ['House Down Payment', `$${house.toLocaleString()}`, '$0', `$${house.toLocaleString()}`, `$${Math.max(0, Math.ceil(house / 12)).toLocaleString()}`, house > 0 && savings > 0 ? Math.ceil(house / savings) : 0],
                [''],
                ['Monthly Income:', `$${income.toLocaleString()}`],
                ['Monthly Expenses:', `$${expenses.toLocaleString()}`],
                ['Monthly Savings:', `$${savings.toLocaleString()}`]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(tracker);
            XLSX.utils.book_append_sheet(wb, ws, 'Financial Tracker');
        }

        function createHolidayPlanSheet(wb, data) {
            const holiday = [
                ['Birthday Trip Planning'],
                [''],
                ['Trip Details'],
                ['Month:', data.tripMonth],
                ['Budget:', `$${parseFloat(data.tripBudget || 0).toLocaleString()}`],
                ['Preferences:', data.tripPreferences],
                ['Location Ideas:', data.locationIdeas],
                [''],
                ['Budget Breakdown'],
                ['Transportation', '30%', `$${Math.round(parseFloat(data.tripBudget || 0) * 0.3).toLocaleString()}`],
                ['Accommodation', '40%', `$${Math.round(parseFloat(data.tripBudget || 0) * 0.4).toLocaleString()}`],
                ['Activities', '20%', `$${Math.round(parseFloat(data.tripBudget || 0) * 0.2).toLocaleString()}`],
                ['Food & Misc', '10%', `$${Math.round(parseFloat(data.tripBudget || 0) * 0.1).toLocaleString()}`],
                [''],
                ['Planning Checklist'],
                [' Research destinations'],
                [' Book transportation'],
                [' Reserve accommodation'],
                [' Plan activities'],
                [' Pack essentials'],
                [' Set budget alerts']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(holiday);
            XLSX.utils.book_append_sheet(wb, ws, 'Holiday Plan');
        }

        function createReadingExerciseSheet(wb, data) {
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            const readingGoal = parseFloat(data.readingGoal || 0);
            const exerciseFreq = parseFloat(data.exerciseFrequency || 0);
            
            const readingExercise = [
                ['Reading & Exercise Tracker'],
                [''],
                ['Monthly Goals'],
                ['Books per month:', readingGoal],
                ['Workouts per week:', exerciseFreq],
                ['Total books this year:', readingGoal * 12],
                ['Total workouts this year:', exerciseFreq * 52],
                [''],
                ['Monthly Calendar'],
                ['Month', 'Books Read', 'Workouts Completed', 'Notes']
            ];
            
            months.forEach(month => {
                readingExercise.push([month, '', '', '']);
            });
            
            readingExercise.push(['']);
            readingExercise.push(['Reading Themes:', data.readingThemes]);
            readingExercise.push(['Exercise Type:', data.exerciseTypes]);
            
            const ws = XLSX.utils.aoa_to_sheet(readingExercise);
            XLSX.utils.book_append_sheet(wb, ws, 'Reading & Exercise');
        }

        function createRoutinesSheet(wb, data) {
            const milestones = [];
            document.querySelectorAll('.milestone-checkbox:checked').forEach(cb => {
                milestones.push(cb.value);
            });
            
            const childAge = parseInt(data.childAge) || 0;
            const ageData = milestonesByAge[childAge] || { title: 'Unknown Age', milestones: [] };
            
            const routines = [
                ['Child Routines & Milestones'],
                [''],
                ['Child Information'],
                ['Age:', data.childAge],
                ['Age Group:', ageData.title],
                ['Birthday Month:', data.birthdayMonth],
                [''],
                ['Daily Routine'],
                ['Wake-up Time:', data.wakeUpTime],
                ['Bedtime:', data.bedtime],
                ['Meal Times:', data.mealTimes],
                [''],
                ['Selected Milestones to Focus On'],
                ...milestones.map(milestone => [milestone, ' In Progress', ' Completed']),
                [''],
                ['All Age-Appropriate Milestones'],
                ...ageData.milestones.map(milestone => [milestone, ' Not Started', ' In Progress', ' Completed']),
                [''],
                ['Weekly Schedule Template'],
                ['Day', 'Morning', 'Afternoon', 'Evening'],
                ['Monday', '', '', ''],
                ['Tuesday', '', '', ''],
                ['Wednesday', '', '', ''],
                ['Thursday', '', '', ''],
                ['Friday', '', '', ''],
                ['Saturday', '', '', ''],
                ['Sunday', '', '', '']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(routines);
            XLSX.utils.book_append_sheet(wb, ws, 'Routines & Child');
        }

        function createInsuranceSheet(wb, data) {
            const healthInsurance = parseFloat(data.healthInsurance || 0);
            const healthDeductible = parseFloat(data.healthDeductible || 0);
            const pediatricianCopay = parseFloat(data.pediatricianCopay || 0);
            const visionDental = parseFloat(data.visionDental || 0);
            const lifeInsurance = parseFloat(data.lifeInsurance || 0);
            const lifeCoverage = parseFloat(data.lifeCoverage || 0);
            const autoInsurance = parseFloat(data.autoInsurance || 0);
            const homeInsurance = parseFloat(data.homeInsurance || 0);
            const disabilityInsurance = parseFloat(data.disabilityInsurance || 0);
            const petInsurance = parseFloat(data.petInsurance || 0);
            
            const insurance = [
                ['Insurance & Protection Plan'],
                [''],
                ['Health Insurance'],
                ['Monthly Premium:', `$${healthInsurance.toLocaleString()}`],
                ['Annual Premium:', `$${(healthInsurance * 12).toLocaleString()}`],
                ['Deductible:', `$${healthDeductible.toLocaleString()}`],
                ['Pediatrician Co-pay:', `$${pediatricianCopay.toLocaleString()}`],
                ['Vision/Dental Monthly:', `$${visionDental.toLocaleString()}`],
                [''],
                ['Life Insurance'],
                ['Monthly Premium:', `$${lifeInsurance.toLocaleString()}`],
                ['Coverage Amount:', `$${lifeCoverage.toLocaleString()}`],
                ['Annual Premium:', `$${(lifeInsurance * 12).toLocaleString()}`],
                [''],
                ['Property Insurance'],
                ['Auto Insurance (Quarterly):', `$${autoInsurance.toLocaleString()}`],
                ['Auto Insurance (Monthly):', `$${(autoInsurance / 3).toLocaleString()}`],
                ['Home/Renters Insurance (Quarterly):', `$${homeInsurance.toLocaleString()}`],
                ['Home/Renters Insurance (Monthly):', `$${(homeInsurance / 3).toLocaleString()}`],
                [''],
                ['Additional Coverage'],
                ['Disability Insurance (Monthly):', `$${disabilityInsurance.toLocaleString()}`],
                ['Pet Insurance (Monthly):', `$${petInsurance.toLocaleString()}`],
                [''],
                ['Total Monthly Insurance Cost:', `$${(healthInsurance + visionDental + lifeInsurance + (autoInsurance/3) + (homeInsurance/3) + disabilityInsurance + petInsurance).toLocaleString()}`],
                ['Total Annual Insurance Cost:', `$${((healthInsurance + visionDental + lifeInsurance + (autoInsurance/3) + (homeInsurance/3) + disabilityInsurance + petInsurance) * 12).toLocaleString()}`],
                [''],
                ['Insurance Review Schedule'],
                ['Health Insurance Review:', 'Annual (Open Enrollment)'],
                ['Life Insurance Review:', 'Every 2-3 years'],
                ['Auto Insurance Review:', 'Every 6 months'],
                ['Home Insurance Review:', 'Annual'],
                ['Disability Insurance Review:', 'Annual']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(insurance);
            XLSX.utils.book_append_sheet(wb, ws, 'Insurance & Protection');
        }

        function createChildcareEducationSheet(wb, data) {
            const currentChildcare = parseFloat(data.currentChildcare || 0);
            const afterSchoolPrograms = parseFloat(data.afterSchoolPrograms || 0);
            const summerCampBudget = parseFloat(data.summerCampBudget || 0);
            const extracurriculars = parseFloat(data.extracurriculars || 0);
            const schoolSupplies = parseFloat(data.schoolSupplies || 0);
            const schoolClothing = parseFloat(data.schoolClothing || 0);
            const educationDeadlines = data.educationDeadlines || '';
            
            const childcareEducation = [
                ['Childcare & Education Logistics'],
                [''],
                ['Current Childcare Costs'],
                ['Monthly Childcare:', `$${currentChildcare.toLocaleString()}`],
                ['After-School Programs:', `$${afterSchoolPrograms.toLocaleString()}`],
                ['Extracurriculars:', `$${extracurriculars.toLocaleString()}`],
                ['Total Monthly Childcare:', `$${(currentChildcare + afterSchoolPrograms + extracurriculars).toLocaleString()}`],
                ['Total Annual Childcare:', `$${((currentChildcare + afterSchoolPrograms + extracurriculars) * 12).toLocaleString()}`],
                [''],
                ['Summer Programs'],
                ['Weekly Camp Budget:', `$${summerCampBudget.toLocaleString()}`],
                ['8-Week Summer Total:', `$${(summerCampBudget * 8).toLocaleString()}`],
                [''],
                ['Education Costs'],
                ['Annual School Supplies:', `$${schoolSupplies.toLocaleString()}`],
                ['Annual School Clothing/Uniforms:', `$${schoolClothing.toLocaleString()}`],
                ['Total Annual Education:', `$${(schoolSupplies + schoolClothing).toLocaleString()}`],
                [''],
                ['Upcoming Deadlines'],
                ['Important Dates:', educationDeadlines],
                [''],
                ['Childcare Planning Checklist'],
                [' Research summer programs'],
                [' Register for after-school activities'],
                [' Budget for school supplies'],
                [' Plan for uniform/clothing needs'],
                [' Schedule childcare backup options'],
                [' Review childcare subsidies eligibility'],
                [''],
                ['Monthly Budget Breakdown'],
                ['Childcare:', `$${(currentChildcare + afterSchoolPrograms + extracurriculars).toLocaleString()}`],
                ['Education (Monthly):', `$${((schoolSupplies + schoolClothing) / 12).toLocaleString()}`],
                ['Summer (Monthly):', `$${((summerCampBudget * 8) / 12).toLocaleString()}`],
                ['Total Monthly:', `$${((currentChildcare + afterSchoolPrograms + extracurriculars) + ((schoolSupplies + schoolClothing) / 12) + ((summerCampBudget * 8) / 12)).toLocaleString()}`]
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(childcareEducation);
            XLSX.utils.book_append_sheet(wb, ws, 'Childcare & Education');
        }

        function createLegalAdministrativeSheet(wb, data) {
            const childSupport = parseFloat(data.childSupport || 0);
            const legalFees = parseFloat(data.legalFees || 0);
            const taxPreparation = parseFloat(data.taxPreparation || 0);
            const willUpdates = parseFloat(data.willUpdates || 0);
            const legalNotes = data.legalNotes || '';
            
            const benefits = [];
            document.querySelectorAll('.benefits-checkbox:checked').forEach(cb => {
                benefits.push(cb.value);
            });
            
            const legalAdmin = [
                ['Legal & Administrative Planning'],
                [''],
                ['Child Support'],
                ['Monthly Child Support:', `$${childSupport.toLocaleString()}`],
                ['Annual Child Support:', `$${(childSupport * 12).toLocaleString()}`],
                [''],
                ['Legal & Professional Services'],
                ['Annual Legal Fees:', `$${legalFees.toLocaleString()}`],
                ['Tax Preparation:', `$${taxPreparation.toLocaleString()}`],
                ['Will/Guardianship Updates:', `$${willUpdates.toLocaleString()}`],
                ['Total Annual Legal Costs:', `$${(legalFees + taxPreparation + willUpdates).toLocaleString()}`],
                [''],
                ['Government Benefits Status'],
                ['Current Benefits:', benefits.length > 0 ? benefits.join(', ') : 'None selected'],
                ...benefits.map(benefit => [benefit, ' Active', ' Needs Renewal', ' Under Review']),
                [''],
                ['Legal & Administrative Notes'],
                ['Important Dates & Actions:', legalNotes],
                [''],
                ['Annual Legal Review Checklist'],
                [' Child support modification review'],
                [' Tax planning consultation'],
                [' Will and guardianship updates'],
                [' Government benefits eligibility review'],
                [' Legal document organization'],
                [' Emergency contact updates'],
                [''],
                ['Monthly Budget'],
                ['Child Support:', `$${childSupport.toLocaleString()}`],
                ['Legal Services (Monthly):', `$${((legalFees + taxPreparation + willUpdates) / 12).toLocaleString()}`],
                ['Total Monthly:', `$${(childSupport + ((legalFees + taxPreparation + willUpdates) / 12)).toLocaleString()}`],
                [''],
                ['Important Contacts'],
                ['Family Attorney:', ''],
                ['Tax Preparer:', ''],
                ['Child Support Office:', ''],
                ['Benefits Office:', ''],
                ['Emergency Guardian:', '']
            ];
            
            const ws = XLSX.utils.aoa_to_sheet(legalAdmin);
            XLSX.utils.book_append_sheet(wb, ws, 'Legal & Administrative');
        }

        // Milestone functions
        function updateMilestones() {
            const childAge = parseInt(document.getElementById('childAge').value) || 0;
            const milestoneInfo = document.getElementById('milestoneInfo');
            const milestonesContainer = document.getElementById('milestonesContainer');
            
            if (childAge >= 0 && childAge <= 17) {
                const ageData = milestonesByAge[childAge];
                milestoneInfo.textContent = `Showing milestones for ${ageData.title}`;
                
                // Clear existing milestones
                milestonesContainer.innerHTML = '';
                
                // Create milestone checkboxes
                ageData.milestones.forEach((milestone, index) => {
                    const milestoneDiv = document.createElement('div');
                    milestoneDiv.className = 'flex items-start space-x-3 p-3 bg-gray-50 rounded-lg';
                    
                    milestoneDiv.innerHTML = `
                        <input type="checkbox" 
                               id="milestone_${index}" 
                               value="${milestone}" 
                               class="milestone-checkbox mt-1 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                        <label for="milestone_${index}" class="text-sm text-gray-700 leading-relaxed">
                            ${milestone}
                        </label>
                    `;
                    
                    milestonesContainer.appendChild(milestoneDiv);
                });
                
                // Add event listeners to new checkboxes
                document.querySelectorAll('.milestone-checkbox').forEach(checkbox => {
                    checkbox.addEventListener('change', saveToLocalStorage);
                });
                
            } else {
                milestoneInfo.textContent = 'Please enter a valid age (0-17) to see age-appropriate milestones';
                milestonesContainer.innerHTML = '<p class="text-gray-500 text-center py-8">No milestones available. Please enter your child\'s age in Step 1.</p>';
            }
        }

        // Toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `px-6 py-3 rounded-lg text-white mb-2 fade-in ${
                type === 'error' ? 'bg-red-500' : 
                type === 'success' ? 'bg-green-500' : 'bg-blue-500'
            }`;
            toast.textContent = message;
            
            toastContainer.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }
    </script>
</body>
</html>
